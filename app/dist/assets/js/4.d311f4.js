(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{743:function(e,t,s){"use strict";s.r(t);var i=s(812),a=s(775);for(var n in a)"default"!==n&&function(e){s.d(t,e,function(){return a[e]})}(n);s(824),s(823);var r=s(86),o=Object(r.a)(a.default,i.a,i.b,!1,null,"224ccb22",null);t.default=o.exports},774:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){return e&&e.__esModule?e:{default:e}}(s(43));t.default={name:"Members",props:["projectID"],data:function(){return{dialogVisible:!1,dialogVisible_reset:!1,isUpdating:!1,isLoading:!1,dataList:[],searchForm:{page:1,size:10,keywords:""},form:{id:"",username:"",password:"",nickname:""},resetForm:{id:"",username:"",password:""},userList:[],roleList:[],total:0,rules:{username:{required:!0,message:"请输入用户名"},password:{required:!0,message:"请输入密码"},nickname:{required:!0,message:"请输入昵称"}},multipleSelection:[]}},computed:{},created:function(){},mounted:function(){this.getDataList()},methods:{handleSearch:function(){this.searchForm.page=1,this.getDataList()},pageChange:function(){this.getDataList()},getDataList:function(){var e=this,t=this.searchForm;this.isLoading=!0,this.$axios({method:"get",url:"/home/users",params:{page:t.page,size:t.size,username:t.keywords}}).then(function(t){e.dataList=t.data||[],e.total=t.total||0,e.isLoading=!1}).catch(function(t){e.$message.error(t),e.isLoading=!1})},handleAdd:function(){this.resetFields("ruleForm"),this.form={id:null,username:"",password:"",nickname:""},this.dialogVisible=!0},handleEdit:function(e){this.resetFields("ruleForm"),this.form={id:e.id,username:e.username,password:e.password,nickname:e.nickname},this.dialogVisible=!0},handleSubmit:function(){var e=this;this.validateForm("ruleForm",function(){var t=e.form;e.isUpdating=!0;var s="POST",i="/home/users";t.id&&(s="PUT",i="/home/users/"+t.id);var a={username:t.username,password:t.password,nickname:t.nickname};e.$axios({method:s,url:i,data:a}).then(function(t){e.isUpdating=!1,e.dialogVisible=!1,e.getDataList(),e.$message.success("操作成功！")}).catch(function(t){e.$message.error(t),e.isUpdating=!1})})},handleReset:function(e){this.resetForm={id:e.id,username:e.username,password:e.password},this.dialogVisible_reset=!0},handleSubmitReset:function(){var e=this;this.validateForm("resetForm",function(){var t=e.resetForm;e.isUpdating=!0;var s="/home/users/"+t.id+"/reset-password",i={password:t.password};e.$axios({method:"PUT",url:s,data:i}).then(function(t){e.isUpdating=!1,e.dialogVisible_reset=!1,e.getDataList(),e.$message.success("操作成功！")}).catch(function(t){e.$message.error(t),e.isUpdating=!1})})},handleDel:function(e){var t=this;this.sureAgain("确认是否移除 "+e.nickname+" ?",function(){t.delAjax(e.id)})},delAjax:function(e){var t=this;this.$axios({method:"DELETE",url:"/home/users/"+e}).then(function(e){t.getDataList(),t.$message.success("操作成功！")}).catch(function(e){t.$message.error(e)})},handelChangeRole:function(e,t){var s=this,i=e.id;this.setRoleAjax(i,t).then(function(e){s.getDataList(),s.$message.success("操作成功！")}).catch(function(e){s.$message.error(e)})},setRoleAjax:function(e,t){var s=this;return new i.default(function(i,a){var n=s.projectID,r={roleId:t};s.$axios({method:"PUT",url:"projects/"+n+"/members/"+e,data:r}).then(function(e){i(e)}).catch(function(e){a(e)})})},handleSelectionChange:function(e){this.multipleSelection=e},clearTableSelectionAll:function(){this.$refs.multipleTable.clearSelection()},removeSelectUser:function(e){var t=this;this.multipleSelection.forEach(function(s,i){s.id==e.id&&(t.multipleSelection.splice(i,1),t.clearTableSelection(e))})},clearTableSelection:function(e){this.$refs.multipleTable.toggleRowSelection(e,!1)},setSelection:function(e){var t=this;e&&e.forEach(function(e){t.$refs.multipleTable.toggleRowSelection(e)})},formatDepartmentName:function(e){return(this.departments.find(function(t){return t.id==e})||{}).name||"--"},sureAgain:function(e,t){this.$confirm(e,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t&&t()}).catch(function(){})},validateForm:function(e,t,s){this.$refs[e].validate(function(e){if(!e)return s&&"function"==typeof s&&s(),!1;t&&"function"==typeof t&&t()})},resetFields:function(e){var t=this;this.$refs[e]&&this.$nextTick(function(){t.$refs[e].resetFields()})}}}},775:function(e,t,s){"use strict";s.r(t);var i=s(774),a=s.n(i);for(var n in i)"default"!==n&&function(e){s.d(t,e,function(){return i[e]})}(n);t.default=a.a},800:function(e,t,s){},801:function(e,t,s){},812:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-page-content"},[s("el-form",{staticClass:"search-form",attrs:{model:e.searchForm,inline:""},nativeOn:{submit:function(e){e.preventDefault()}}},[s("el-form-item",{attrs:{label:"用户名"}},[s("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"用户名关键词",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.searchForm.keywords,callback:function(t){e.$set(e.searchForm,"keywords",t)},expression:"searchForm.keywords"}},[s("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},on:{click:e.handleSearch},slot:"suffix"})])],1),e._v(" "),s("el-form-item",{staticStyle:{float:"right"}},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleAdd}},[e._v("添加用户")])],1)],1),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],attrs:{data:e.dataList,"element-loading-spinner":"el-icon-loading","element-loading-text":"数据加载中...",stripe:""}},[s("el-table-column",{attrs:{prop:"id",label:"ID",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"username",label:"用户名"}}),e._v(" "),s("el-table-column",{attrs:{prop:"nickname",label:"昵称"}}),e._v(" "),s("el-table-column",{attrs:{prop:"creationTime",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(e._f("formatDate")(1e3*t.row.creationTime))+"\n            ")]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(s){return e.handleEdit(t.row,t.$index)}}},[e._v("编辑\n                ")]),e._v(" "),s("el-button",{staticClass:"danger-color",attrs:{size:"mini",type:"text"},on:{click:function(s){return e.handleDel(t.row,t.$index)}}},[e._v("移除\n                ")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(s){return e.handleReset(t.row,t.$index)}}},[e._v("重置密码\n                ")])]}}])})],1),e._v(" "),s("div",{staticClass:"pagination-wrapper"},[s("el-pagination",{attrs:{layout:"total, prev, pager, next, jumper","current-page":e.searchForm.page,"page-size":e.searchForm.size,total:e.total},on:{"current-change":e.pageChange,"update:currentPage":function(t){return e.$set(e.searchForm,"page",t)},"update:current-page":function(t){return e.$set(e.searchForm,"page",t)}}})],1),e._v(" "),s("el-dialog",{attrs:{title:(e.form.id?"编辑":"添加")+"用户",visible:e.dialogVisible,width:"540px","custom-class":"padding-dialog","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"用户名：",prop:"username"}},[s("el-input",{attrs:{size:"small",disabled:Boolean(e.form.id),"auto-complete":"new-password",maxlength:"20","show-word-limit":""},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"呢称：",prop:"nickname"}},[s("el-input",{attrs:{size:"small",maxlength:"20","show-word-limit":""},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),e._v(" "),e.form.id?e._e():s("el-form-item",{attrs:{label:"密码：",prop:"password"}},[s("el-input",{attrs:{size:"small","auto-complete":"new-password","show-password":""},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1)],1),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{size:"small",type:"primary",loading:e.isUpdating},on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"重置密码",visible:e.dialogVisible_reset,width:"540px","custom-class":"padding-dialog","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible_reset=t}}},[s("el-form",{ref:"resetForm",attrs:{model:e.resetForm,rules:e.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"用户名：",prop:"username"}},[s("el-input",{attrs:{size:"small",disabled:"","auto-complete":"new-password",maxlength:"20","show-word-limit":""},model:{value:e.resetForm.username,callback:function(t){e.$set(e.resetForm,"username",t)},expression:"resetForm.username"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"密码：",prop:"password"}},[s("el-input",{attrs:{size:"small","auto-complete":"new-password","show-password":""},model:{value:e.resetForm.password,callback:function(t){e.$set(e.resetForm,"password",t)},expression:"resetForm.password"}})],1)],1),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible_reset=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{size:"small",type:"primary",loading:e.isUpdating},on:{click:e.handleSubmitReset}},[e._v("确 定")])],1)],1)],1)},a=[];s.d(t,"a",function(){return i}),s.d(t,"b",function(){return a})},823:function(e,t,s){"use strict";s(800)},824:function(e,t,s){"use strict";s(801)}}]);